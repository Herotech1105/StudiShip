<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>StudyShip</title>
    <link rel="icon" href="./icons/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="/styles/styles.css">
    <link rel="stylesheet" href="/styles/room.css">

</head>
    <body data-is-owner="{{isOwner}}">
        <header>
            <nav>
                <a href="/" class="logo">StudyShip ðŸ“–</a>
                <div class="mobile-menu">
                    <a href="/createRoom">Erstellen</a>
                    <a href="/search">Suchen</a>
                    <form action="/logout" method="POST" class="logout-form">
                        <button type="submit" class="logout-link-style">Abmelden</button>
                    </form>
                </div>
            </nav>
        </header>

        <main >
            <script src="/socket.io/socket.io.js"></script>
            <script src="/scripts/room.js" defer></script>
            <div class="red-rounded-box header-box">
                <h1 id="roomTitle" contenteditable="false">{{room.name}}</h1><!--false for User-->
            </div>
            <div class="room-layout">
                <section class="room-info">

                    <div id="subject" class="border-box sub-header">
                        <span id="roomSubjectText">{{room.subject}}</span>
                        {{#if isOwner}}
                            <select class="form-control hidden" id="roomSubject" name="roomSubject">
                                {{#each subjects}}
                                    <option value="{{this}}">{{this}}</option>
                                {{/each}}
                            </select>
                        {{/if}}
                    </div>

                    <div id="description" class="border-box">
                        <p id="roomDescription" contenteditable="false">{{room.description}}</p>
                    </div>

                    <div class="red-rounded-box members-field">
                        <h3>Mitglieder:</h3>
                        <button class="share-btn">ðŸ”— teilen</button>
                        <ul>
                            {{#each members}}
                                <li>{{this.name}}
                                    <span>{{this.name}}</span>
                                    {{#if ../isOwner}}
                                        <button class="kickUserButton owner-edit-only hidden" onclick="changeOwner('{{this.name}}')">Zum Admin</button>
                                        <button class="kickUserButton owner-edit-only hidden" onclick="removeUser('{{this.name}}')">x</button>
                                    {{/if}}
                                </li>
                            {{/each}}
                        </ul>
                    </div>
                    {{#if isOwner}}
                        <button id="editButton" onclick="editRoom()">Bearbeiten</button>
                        <button id="saveButton" class="hidden" onclick="updateRoom()">Speichern</button>
                        <button id="deleteButton" class="owner-edit-only hidden" onclick="deleteRoom()">Raum lÃ¶schen</button>
                    {{/if}}
                    <button onclick="leaveRoom()">Verlassen</button>
                </section>

                <aside class="chat-area"><!--CSS:move the chat a bit up so you don't need to scroll down evertime you open the window-->
                    <h4>Nachrichten:</h4>
                    <ul id="messages" class="chat-window">
                        {{#each messages}}
                            <li class="message-bubble">{{this.user}}<small>[{{this.timestamp}}]</small>: {{this.content}}</li>
                        {{/each}}
                    </ul>
                    <div class="chat-input">
                        <input type="text" name="message" id="message" placeholder="...">
                        <button onclick="sendMessage()" class="send-button">âž¤</button>
                    </div>
                </aside>
            </div>
        </main>
        <footer>
            <p>Diese Seite wurde erstellt von Barnabas Steiner, Tim Dorotzki, Lennart Esch und Jannis Weber</p>
            <p>Nur zur internen Verwendung an der DHBW Ravensburg Campus Friedrichshafen.</p>
        </footer>

        <!--
        CSS: Remove the <style> and eddit the .confimation windows and the buttons .yes-btn .no-btn
        -->
        <div style=" position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999; " class="user-kick-confirmation-window">
            <div class="confirmation-window">
                <h2>Warnung!</h2>
                <p>Wollen sie wirklich den Nutzer entfernen?</p>
                <button id="kick-confirmation" class="yes-btn">ja</button>
                <button id="kick-rejected" class="no-btn">nein</button>
            </div>
        </div>
        <div style=" position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999; " class="new-admin-confirmation-window">
            <div class="confirmation-window">
                <h2>Warnung!</h2>
                <p>Wollen sie geben ihre Adminrechte abgeben?</p>
                <button id="new-admin-confirmation" class="yes-btn">ja</button>
                <button id="new-admin-rejected" class="no-btn">nein</button>
            </div>
        </div>
        <div style=" position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999; " class="delition-confirmation-window">
            <div class="confirmation-window">
                <h2>Warnung!</h2>
                <p>Wollen sie unwiederbringlich die Gruppe fÃ¼r alle lÃ¶schen?</p>
                <button id="delition-confirmation" class="yes-btn">ja</button>
                <button id="delition-rejected" class="no-btn">nein</button>
            </div>
        </div>
    </body>
</html>